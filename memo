ã‚¨ãƒ©ãƒ¼åŸå› ã¯ã“ã“ã§ã™ğŸ‘‡
	â€¢	EvaluateExprCached ã®ç¬¬1å¼•æ•°ã¯ Collection å‹ï¼ˆæ—¢å®šã§ ByRefï¼‰
	â€¢	ãªã®ã« defLinesCache(c) ãŒ Variantï¼ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‚ç…§å…¥ã‚Šï¼‰ã ã£ãŸãŸã‚ã€
ByRefå¼•æ•°ã®å‹ä¸ä¸€è‡´ ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚

å®‰å…¨ã«ç›´ã™ã«ã¯ 2ç‚¹ ã ã‘å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚

â¸»

â‘  defLinesCache ã‚’ Collection é…åˆ—ã«ã™ã‚‹

' å¤‰æ›´å‰
Dim defLinesCache() As Variant
ReDim defLinesCache(1 To cols)

' å¤‰æ›´å¾Œ
Dim defLinesCache() As Collection
ReDim defLinesCache(1 To cols)

For c = 1 To cols
    If Map_Mode(c) = "EXPR" Then
        ' 1åˆ—ã«ã¤ã1å›ã ã‘åˆ†å‰²
        Set defLinesCache(c) = SplitExprToLines(Map_Def(c))   ' â† Collection ã‚’æ ¼ç´
    Else
        Set defLinesCache(c) = Nothing
    End If
Next

â‘¡ EvaluateExprCached ã®å¼•æ•°ã‚’ ByVal ã«ã™ã‚‹

ByRef ã®ã¾ã¾ã§ã‚‚å‹•ãã¾ã™ãŒã€é…åˆ—è¦ç´ ã‚’æ¸¡ã™æ™‚ã®å‹å³æ ¼æ€§ã§ãƒãƒã‚Šã¥ã‚‰ãã™ã‚‹ãŸã‚ ByVal ã«ã—ã¦ãŠãã®ãŒãŠã™ã™ã‚ã§ã™ã€‚

' å¤‰æ›´å‰
Public Function EvaluateExprCached(defLines As Collection, baseTbl As String, baseRow As Long, myKey As String, _
                                   ByVal processed As Boolean, Optional outColIndex As Long = -1) As Variant

' å¤‰æ›´å¾Œ
Public Function EvaluateExprCached(ByVal defLines As Collection, baseTbl As String, baseRow As Long, myKey As String, _
                                   ByVal processed As Boolean, Optional outColIndex As Long = -1) As Variant

ã“ã‚Œã§ã€

dst(r, c) = EvaluateExprCached(defLinesCache(c), ... )

ã®å‘¼ã³å‡ºã—ãŒå‹ä¸€è‡´ã—ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒé€šã‚Šã¾ã™ã€‚

â¸»

ï¼ˆãŠã¾ã‘ï¼šæ°—ã¥ãï¼‰

è²¼ã£ã¦ã„ãŸã ã„ãŸã‚³ãƒ¼ãƒ‰ã ã¨ã€ä¸‹è¨˜2ç®‡æ‰€ã§å…ƒã®å®Ÿè£…ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ãŸã¾ã¾ã«ãªã£ã¦ã„ã‚‹ãŸã‚ã€æ•°å¼ç½®æ›ãŒå¸¸ã« "0" ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ï¼ˆæ€§èƒ½ã«ã¯é–¢ä¿‚ãªã„ã§ã™ãŒã€çµæœãŒå¤‰ã‚ã‚‹å¯èƒ½æ€§ã‚ã‚Šï¼‰ã€‚

' ReplaceTokensWithRawï¼š
' valStr = ResolveTokenRaw(token, baseTbl, baseRow, myKey)
valStr = ToNumberOrZero(valStr)   ' â† valStr ãŒç©ºã®ã¾ã¾ 0 ã«ãªã‚‹

' ReplaceTokensProcessedAsNumberï¼š
' valStr = ResolveTokenProcessed(token, baseTbl, baseRow, myKey, outColIndex)
valStr = ToNumberOrZero(valStr)   ' â† åŒä¸Š

æœ¬æ¥ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å¤–ã—ã¦ã€å–å¾— â†’ æ•°å€¤åŒ–ã®é †ã«ã—ã¦ãã ã•ã„ã€‚

valStr = ResolveTokenRaw(token, baseTbl, baseRow, myKey)
valStr = ToNumberOrZero(valStr)

valStr = ResolveTokenProcessed(token, baseTbl, baseRow, myKey, outColIndex)
valStr = ToNumberOrZero(valStr)


â¸»

ä¸æ˜ç‚¹ã‚ã‚Œã°ã€è©²å½“ç®‡æ‰€ã ã‘æŠœç²‹ã§é€ã£ã¦ã„ãŸã ã‘ã‚Œã°ãã®å ´ã§ç›´ã—ã¾ã™ï¼