以下のDim experが"0+0+0+0+0"のようになってました。



Public Function EvaluateExpr(def As String, baseTbl As String, baseRow As Long, myKey As String, _
                             ByVal processed As Boolean, Optional outColIndex As Long = -1) As Variant
    Dim lines As Collection: Set lines = SplitExprToLines(def)
    Dim i As Long, one As String, res As String, acc As String
    For i = 1 To lines.Count
        one = Trim$(lines(i))
        If one = "" Then GoTo CONT
        If HasIFSyntax(one) Then
            res = EvalIFLine(one, baseTbl, baseRow, myKey, processed, outColIndex)
            If Len(res) > 0 Then
                If acc = "" Then acc = res Else acc = acc & vbLf & res
            End If
        ElseIf InStr(one, """") > 0 Or InStr(one, "'") > 0 Then
            res = ApplyTemplate(one, baseTbl, baseRow, myKey, processed, outColIndex)
            If Len(res) > 0 Then
                If acc = "" Then acc = res Else acc = acc & vbLf & res
            End If
        Else
            Dim expr As String
            If processed Then
                expr = ReplaceTokensProcessedAsNumber(one, baseTbl, baseRow, myKey, outColIndex)
            Else
                expr = ReplaceTokensWithRaw(one, baseTbl, baseRow, myKey)
            End If
            res = CStr(SafeEval(expr))
            If acc = "" Then acc = res Else acc = acc & vbLf & res
        End If
